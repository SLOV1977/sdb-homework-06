                                                                  [Клиент] → [Балансировщик нагрузки] → [Master-сервер]
                                                                                        |
 _______________________________________________________________________________________|
|
|
|
|                                                      ___________________________________________________________________ 
|                                                     |Horizontal shard 1                                                 |
|                                                     |                                                                   |
|_____________________________________________________|Пользователи: Разбиение по диапазону ID 1-50000                    |
|                                                     |Книги: Разбиение по хэш-функции genre_id % 3 = 0                   |
|                                                     |Магазины: Разбиение по географическому признаку (регионы России)   |
|                                                     |___________________________________________________________________|
|                                                                                       |
|                               ________________________________________________________|________________________________________________________
|                              |                                                        |                                                        |
|     _________________________|_________________________      _________________________|_________________________      _________________________|_________________________
|    |Vertical shard 1                                   |    |Vertical shard 2                                   |    |Vertical shard 3                                   |
|    |                                                   |    |                                                   |    |                                                   |
|    |Пользователи: id, username, email, password_hash   |    |Пользователи: first_name, last_name, phone, address|    |Пользователи: payment_info, purchase_history       |
|    |Книги: id, title, author                           |    |Книги: description, price, stock                   |    |Книги: reviews, ratings, tags                      |
|    |Магазины: id, name, location, contact              |    |Магазины: inventory, pricing, discounts            |    |Магазины: staff_info, working_hours                |
|    |___________________________________________________|    |___________________________________________________|    |___________________________________________________|
|        
|
|
|                                                      ___________________________________________________________________ 
|                                                     |Horizontal shard 2                                                 |
|                                                     |                                                                   |
|_____________________________________________________|Пользователи: Разбиение по диапазону ID 50001-100000               |
|                                                     |Книги: Разбиение по хэш-функции genre_id % 3 = 1                   |
|                                                     |Магазины: Разбиение по географическому признаку (регионы СНГ)      |
|                                                     |___________________________________________________________________|
|                                                                                       |
|                               ________________________________________________________|________________________________________________________
|                              |                                                        |                                                        |
|     _________________________|_________________________      _________________________|_________________________      _________________________|_________________________
|    |Vertical shard 1                                   |    |Vertical shard 2                                   |    |Vertical shard 3                                   |
|    |                                                   |    |                                                   |    |                                                   |
|    |Пользователи: id, username, email, password_hash   |    |Пользователи: first_name, last_name, phone, address|    |Пользователи: payment_info, purchase_history       |
|    |Книги: id, title, author                           |    |Книги: description, price, stock                   |    |Книги: reviews, ratings, tags                      |
|    |Магазины: id, name, location, contact              |    |Магазины: inventory, pricing, discounts            |    |Магазины: staff_info, working_hours                |
|    |___________________________________________________|    |___________________________________________________|    |___________________________________________________|
|
|
|
|                                                      ___________________________________________________________________ 
|                                                     |Horizontal shard 3                                                 |
|                                                     |                                                                   |
|_____________________________________________________|Пользователи: Разбиение по диапазону ID 100001+                    |
                                                      |Книги: Разбиение по хэш-функции genre_id % 3 = 2                   |
                                                      |Магазины: Разбиение по географическому признаку (международные)    |
                                                      |___________________________________________________________________|
                                                                                        |
                                ________________________________________________________|________________________________________________________
                               |                                                        |                                                        |
      _________________________|_________________________      _________________________|_________________________      _________________________|_________________________
     |Vertical shard 1                                   |    |Vertical shard 2                                   |    |Vertical shard 3                                   |
     |                                                   |    |                                                   |    |                                                   |
     |Пользователи: id, username, email, password_hash   |    |Пользователи: first_name, last_name, phone, address|    |Пользователи: payment_info, purchase_history       |
     |Книги: id, title, author                           |    |Книги: description, price, stock                   |    |Книги: reviews, ratings, tags                      |
     |Магазины: id, name, location, contact              |    |Магазины: inventory, pricing, discounts            |    |Магазины: staff_info, working_hours                |
     |___________________________________________________|    |___________________________________________________|    |___________________________________________________|


